@page "/all-users"

@using StudentSystem.Client.Services.AuthServices
@using StudentSystem.Shared.DTOs
@using StudentSystem.Shared.Models
@inject IClientAuthService ClientAuthService
@inject NavigationManager NavigationManager

<PageTitle>Users</PageTitle>
<h1>Users</h1>

<MudTable Items="ClientAuthService.users" Hover="true" Striped="true" Dense="true" Class="mb-2">
    <HeaderContent>
        <MudTh>Image</MudTh>
        <MudTh>Email</MudTh>
        <MudTh>Role</MudTh>

    </HeaderContent>
    <RowTemplate Context="userDetails">
        @if (userDetails.Role == "Admin")
        {
            <MudTd DataLabel="Image"><MudAvatar Image="@userDetails.Avatar"></MudAvatar></MudTd>
        }
        else if(userDetails.Role == "Student" && userDetails.Student != null) 
        {
            <MudTd DataLabel="Image"><MudAvatar Image="@userDetails.Student.Image"></MudAvatar></MudTd>

        }
        else if (userDetails.Role == "Professor" && userDetails.Professor != null)
        {
            <MudTd DataLabel="Image"><MudAvatar Image="@userDetails.Professor.Image"></MudAvatar></MudTd>
        }

        <MudTd DataLabel="Email">
            @userDetails.Email
        </MudTd>
        <MudTd DataLabel="Role">
            @userDetails.Role
        </MudTd>
    </RowTemplate>
</MudTable>

<MudButton ButtonType="ButtonType.Submit" Color="Color.Primary" Variant="Variant.Filled" OnClick="RegisterUser">Add User</MudButton>


@code {

    List<User> userDetails = new List<User>();

    protected override async Task OnInitializedAsync()
    {
        userDetails = await ClientAuthService.GetAllUser();
    }

    void RegisterUser()
    {
        NavigationManager.NavigateTo("/register");
    }

}
